---
import BaseLayout from '../../layouts/BaseLayout.astro';

// Read the terms and conditions markdown file with error handling
let termsContent = '';
try {
  // Try to read the file, but provide fallback content if it fails
  const fs = await import('fs/promises');
  termsContent = await fs.readFile('WIPP_Terms_and_Conditions.md', 'utf-8');
} catch (error) {
  console.warn('Could not read terms file, using fallback content:', error.message);
  termsContent = `# Terms and Conditions

## Welcome to WIPP

These terms and conditions outline the rules and regulations for the use of WIPP's Website.

By accessing this website, we assume you accept these terms and conditions. Do not continue to use WIPP if you do not agree to take all of the terms and conditions stated on this page.

## Use License

Permission is granted to temporarily download one copy of the materials on WIPP's website for personal, non-commercial transitory viewing only.

## Disclaimer

The materials on WIPP's website are provided on an 'as is' basis. WIPP makes no warranties, expressed or implied, and hereby disclaims and negates all other warranties including without limitation, implied warranties or conditions of merchantability, fitness for a particular purpose, or non-infringement of intellectual property or other violation of rights.

## Contact Information

If you have any questions about these Terms and Conditions, please contact us.

*Last updated: December 2024*`;
}

// Convert markdown to HTML (basic conversion)
function markdownToHtml(markdown: string): string {
  return markdown
    .replace(/^# (.*$)/gm, '<h1 class="text-3xl font-bold mb-6 text-neutral-900 dark:text-white">$1</h1>')
    .replace(/^## (.*$)/gm, '<h2 class="text-2xl font-semibold mb-4 mt-8 text-neutral-900 dark:text-white">$1</h2>')
    .replace(/^### (.*$)/gm, '<h3 class="text-xl font-medium mb-3 mt-6 text-neutral-900 dark:text-white">$1</h3>')
    .replace(/^\*\*(.*?)\*\*/gm, '<strong class="font-semibold text-neutral-900 dark:text-white">$1</strong>')
    .replace(/^\*(.*?)\*/gm, '<em class="italic">$1</em>')
    .replace(/^- (.*$)/gm, '<li class="mb-2 text-neutral-700 dark:text-neutral-300">$1</li>')
    .replace(/\n\n/g, '</p><p class="mb-4 text-neutral-700 dark:text-neutral-300 leading-relaxed">')
    .replace(/^(?!<[h|l|p])/gm, '<p class="mb-4 text-neutral-700 dark:text-neutral-300 leading-relaxed">')
    .replace(/(<li.*<\/li>)/gs, '<ul class="list-disc list-inside mb-4 space-y-2">$1</ul>')
    .replace(/<\/p>$/g, '');
}

const htmlContent = markdownToHtml(termsContent);
---

<BaseLayout title="Terms & Conditions">
  <div class="max-w-4xl mx-auto px-6 py-12">
    
    <!-- Header -->
    <div class="text-center mb-12">
      <h1 class="text-4xl font-bold text-neutral-900 dark:text-white mb-4">Terms & Conditions</h1>
      <p class="text-neutral-600 dark:text-neutral-400 text-lg">
        Last updated: December 2024
      </p>
    </div>

    <!-- Content -->
    <div class="prose prose-neutral dark:prose-invert max-w-none">
      <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-8 shadow-sm">
        <div set:html={htmlContent}></div>
      </div>
    </div>

    <!-- Navigation -->
    <div class="mt-12 flex justify-between items-center">
      <a href="/legal/summary" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium">
        ← Legal Summary
      </a>
      <a href="/legal/privacy" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium">
        Privacy Policy →
      </a>
    </div>

  </div>
</BaseLayout>