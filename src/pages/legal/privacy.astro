---
import BaseLayout from '../../layouts/BaseLayout.astro';

// Read the privacy policy markdown file with error handling
let privacyContent = '';
try {
  const fs = await import('fs/promises');
  privacyContent = await fs.readFile('WIPP_Privacy_Policy.md', 'utf-8');
} catch (error) {
  console.warn('Could not read privacy file, using fallback content:', error.message);
  privacyContent = `# Privacy Policy

## Information We Collect

We collect information you provide directly to us, such as when you create an account, post content, or contact us.

## How We Use Your Information

We use the information we collect to provide, maintain, and improve our services.

## Information Sharing

We do not sell, trade, or otherwise transfer your personal information to third parties without your consent.

## Data Security

We implement appropriate security measures to protect your personal information.

## Your Rights

You have the right to access, update, or delete your personal information.

## Contact Us

If you have any questions about this Privacy Policy, please contact us.

*Last updated: December 2024*`;
}

// Convert markdown to HTML (basic conversion)
function markdownToHtml(markdown: string): string {
  return markdown
    .replace(/^# (.*$)/gm, '<h1 class="text-3xl font-bold mb-6 text-neutral-900 dark:text-white">$1</h1>')
    .replace(/^## (.*$)/gm, '<h2 class="text-2xl font-semibold mb-4 mt-8 text-neutral-900 dark:text-white">$1</h2>')
    .replace(/^### (.*$)/gm, '<h3 class="text-xl font-medium mb-3 mt-6 text-neutral-900 dark:text-white">$1</h3>')
    .replace(/^\*\*(.*?)\*\*/gm, '<strong class="font-semibold text-neutral-900 dark:text-white">$1</strong>')
    .replace(/^\*(.*?)\*/gm, '<em class="italic">$1</em>')
    .replace(/^- (.*$)/gm, '<li class="mb-2 text-neutral-700 dark:text-neutral-300">$1</li>')
    .replace(/\n\n/g, '</p><p class="mb-4 text-neutral-700 dark:text-neutral-300 leading-relaxed">')
    .replace(/^(?!<[h|l|p])/gm, '<p class="mb-4 text-neutral-700 dark:text-neutral-300 leading-relaxed">')
    .replace(/(<li.*<\/li>)/gs, '<ul class="list-disc list-inside mb-4 space-y-2">$1</ul>')
    .replace(/<\/p>$/g, '');
}

const htmlContent = markdownToHtml(privacyContent);
---

<BaseLayout title="Privacy Policy">
  <div class="max-w-4xl mx-auto px-6 py-12">
    
    <!-- Header -->
    <div class="text-center mb-12">
      <h1 class="text-4xl font-bold text-neutral-900 dark:text-white mb-4">Privacy Policy</h1>
      <p class="text-neutral-600 dark:text-neutral-400 text-lg">
        Last updated: December 2024
      </p>
    </div>

    <!-- Content -->
    <div class="prose prose-neutral dark:prose-invert max-w-none">
      <div class="bg-white dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-8 shadow-sm">
        <div set:html={htmlContent}></div>
      </div>
    </div>

    <!-- Navigation -->
    <div class="mt-12 flex justify-between items-center">
      <a href="/legal/terms" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium">
        ← Terms & Conditions
      </a>
      <a href="/legal/community-guidelines" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 font-medium">
        Community Guidelines →
      </a>
    </div>

  </div>
</BaseLayout>